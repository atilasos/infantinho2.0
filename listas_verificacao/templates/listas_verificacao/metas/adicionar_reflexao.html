{% extends 'listas_verificacao/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Adicionar Reflexão - {{ meta.titulo }}{% endblock %}

{% block listas_content %}
<div class="container mt-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'listas_verificacao:lista_metas' %}">Metas</a></li>
            <li class="breadcrumb-item"><a href="{% url 'listas_verificacao:detalhe_meta' meta.id %}">{{ meta.titulo }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">Adicionar Reflexão</li>
        </ol>
    </nav>

    <div class="card">
        <div class="card-header">
            <h2 class="card-title h5 mb-0">Adicionar Reflexão</h2>
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}
                
                <div class="mb-3">
                    <label for="conteudo" class="form-label">Reflexão</label>
                    <textarea name="conteudo" id="conteudo" class="form-control" rows="5" required></textarea>
                    <div class="form-text">Compartilhe suas reflexões sobre o progresso desta meta.</div>
                </div>

                <div class="mb-3">
                    <label for="nivel_satisfacao" class="form-label">Nível de Satisfação</label>
                    <select name="nivel_satisfacao" id="nivel_satisfacao" class="form-select" required>
                        <option value="">Selecione...</option>
                        <option value="1">1 - Muito Insatisfeito</option>
                        <option value="2">2 - Insatisfeito</option>
                        <option value="3">3 - Neutro</option>
                        <option value="4">4 - Satisfeito</option>
                        <option value="5">5 - Muito Satisfeito</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="dificuldades_encontradas" class="form-label">Dificuldades Encontradas</label>
                    <textarea name="dificuldades_encontradas" id="dificuldades_encontradas" class="form-control" rows="3"></textarea>
                    <div class="form-text">Descreva as dificuldades que você encontrou até agora.</div>
                </div>

                <div class="mb-3">
                    <label for="estrategias_sucesso" class="form-label">Estratégias de Sucesso</label>
                    <textarea name="estrategias_sucesso" id="estrategias_sucesso" class="form-control" rows="3"></textarea>
                    <div class="form-text">Que estratégias foram bem-sucedidas no seu progresso?</div>
                </div>

                <div class="mb-3">
                    <label for="sugestoes_melhoria" class="form-label">Sugestões de Melhoria</label>
                    <textarea name="sugestoes_melhoria" id="sugestoes_melhoria" class="form-control" rows="3"></textarea>
                    <div class="form-text">Que sugestões você tem para melhorar seu progresso?</div>
                </div>

                <div class="d-flex justify-content-end gap-2">
                    <a href="{% url 'listas_verificacao:detalhe_meta' meta.id %}" class="btn btn-secondary">Cancelar</a>
                    <button type="submit" class="btn btn-primary">Salvar Reflexão</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block javascript %}
<script>
    $(document).ready(function() {
        // Adiciona classes do Bootstrap 5 aos campos do formulário
        $('form').find('input, select, textarea').addClass('form-control');
        
        // Inicializa tooltips do Bootstrap
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });
    });
</script>
{% endblock %} 